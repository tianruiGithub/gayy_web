KindEditor.plugin("emoticons",function(e){var n=this,i="emoticons",s=n.emoticonsPath||n.pluginsPath+"emoticons/images/",o=n.allowPreviewEmoticons===undefined||n.allowPreviewEmoticons,a=1;n.clickToolbar(i,function(){function t(i,o,a){w?i.mouseover(function(){o>h?(w.css("left",0),w.css("right","")):(w.css("left",""),w.css("right",0)),C.attr("src",s+a+".gif"),e(this).addClass("ke-on")}):i.mouseover(function(){e(this).addClass("ke-on")}),i.mouseout(function(){e(this).removeClass("ke-on")}),i.click(function(e){n.insertHtml('<img src="'+s+a+'.gif" border="0" alt="" />').hideMenu().focus(),e.stop()})}function c(n,i){var o=document.createElement("table");i.append(o),w&&(e(o).mouseover(function(){w.show("block")}),e(o).mouseout(function(){w.hide()}),b.push(e(o))),o.className="ke-table",o.cellPadding=0,o.cellSpacing=0,o.border=0;for(var a=(n-1)*m+v,c=0;c<d;c++)for(var r=o.insertRow(c),l=0;l<p;l++){var u=e(r.insertCell(l));u.addClass("ke-cell"),t(u,l,a);var f=e('<span class="ke-img"></span>').css("background-position","-"+24*a+"px 0px").css("background-image","url("+s+"static.gif)");u.append(f),b.push(u),a++}return o}function r(){e.each(b,function(){this.unbind()})}function l(e,n){e.click(function(e){r(),E.parentNode.removeChild(E),P.remove(),E=c(n,k),u(n),a=n,e.stop()})}function u(n){P=e('<div class="ke-page"></div>'),k.append(P);for(var i=1;i<=g;i++){if(n!==i){var s=e('<a href="javascript:;">['+i+"]</a>");l(s,i),P.append(s),b.push(s)}else P.append(e("@["+i+"]"));P.append(e("@&nbsp;"))}}var d=5,p=9,f=135,v=0,m=d*p,g=Math.ceil(f/m),h=Math.floor(p/2),k=e('<div class="ke-plugin-emoticons"></div>'),b=[];n.createMenu({name:i,beforeRemove:function(){r()}}).div.append(k);var w,C;o&&(w=e('<div class="ke-preview"></div>').css("right",0),C=e('<img class="ke-preview-img" src="'+s+v+'.gif" />'),k.append(w),w.append(C));var P,E=c(a,k);u(a)})});